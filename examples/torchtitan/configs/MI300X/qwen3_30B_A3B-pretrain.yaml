work_group: ${PRIMUS_TEAM:amd}
user_name: ${PRIMUS_USER:root}
exp_name: ${PRIMUS_EXP_NAME:qwen3_30B_A3B-pretrain}
workspace: ./output

modules:
  pre_trainer:
    framework: torchtitan
    config: pre_trainer.yaml

    # model to run
    model: qwen3_30B_A3B.yaml
    overrides:
      sink_level: null
      file_sink_level: DEBUG
      stderr_sink_level: INFO

      metrics:
        log_freq: 1
        enable_wandb: false

      lr_scheduler:
        warmup_steps: 10

      training:
        local_batch_size: 2
        seq_len: 4096
        mock_data: false
        steps: 50

      parallelism:
        data_parallel_replicate_degree: 1
        data_parallel_shard_degree: -1
        tensor_parallel_degree: 1
        expert_parallel_degree: 1
        expert_tensor_parallel_degree: 1

      activation_checkpoint:
        mode: "selective"
        selective_ac_option: "op"

      primus_turbo:
        enable_primus_turbo: true
        enable_attention_float8: false